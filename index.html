<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>인증사회적기업(주)문화락</title>
  <style>
    :root{
      --k100:#000;
      --gray-1:#111;
      --gray-2:#333;
      --gray-3:#666;
      --line:#e8e8e8;
      --footer-bg: #efe6d9;
      --max: 1200px;
      --shadow: 0 10px 30px rgba(0,0,0,.12);
      --radius: 14px;
      --badge1:#d81b60;
      --badge2:#039be5;
    }

    body{
      margin:0;
      font-family: "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--gray-1);
      background:#fff;
    }
    a{ color:inherit; text-decoration:none; }
    img{ max-width:100%; display:block; }
    button{ font-family:inherit; }
    .wrap{ width:min(var(--max), calc(100% - 32px)); margin:0 auto; }

    header{
      position:sticky;
      top:0;
      z-index:50;
      background:rgba(255,255,255,.92);
      backdrop-filter: blur(8px);
      border-bottom:1px solid var(--line);
    }
    .topbar{
      display:grid;
      grid-template-columns: 220px 1fr 220px;
      align-items:center;
      gap:12px;
      padding:10px 0;
    }
    .brand-left{
      display:flex;
      align-items:center;
      gap:10px;
      min-height:44px;
    }
    .brand-left img{
      height:34px;
      width:auto;
      object-fit:contain;
    }
    .brand-title{
      text-align:center;
      font-weight:800;
      letter-spacing:-.02em;
      font-size:18px;
    }
    .brand-right{
      display:flex;
      justify-content:flex-end;
      align-items:center;
      gap:8px;
      min-height:44px;
    }

    nav{ border-top:1px solid var(--line); }
    .menu{
      display:flex;
      gap:22px;
      justify-content:center;
      align-items:center;
      padding:10px 0;
      flex-wrap:wrap;
    }
    .menu a{
      font-weight:700;
      color:var(--k100);
      font-size:15px;
      letter-spacing:-.02em;
      padding:6px 2px;
    }
    .menu a.active{
      text-decoration: underline;
      text-underline-offset: 6px;
      text-decoration-thickness: 2px;
    }

    .section{ padding:38px 0 26px; }
    .section-title{
      font-size:30px;
      font-weight:800;
      letter-spacing:-.03em;
      margin:0 0 18px;
    }
    .muted{ color:var(--gray-3); }

    .hero{
      position:relative;
      width:100%;
      height: clamp(260px, 46vw, 520px);
      overflow:hidden;
      background:#000;
    }
    .hero-track{
      position:absolute;
      inset:0;
      display:flex;
      height:100%;
      will-change: transform;
      transition: transform 1200ms ease-in-out;
    }
    .hero-slide{
      min-width:100%;
      height:100%;
      position:relative;
    }
    .hero-slide img{
      width:100%;
      height:100%;
      object-fit:cover;
      opacity:.92;
    }
    .hero-overlay{
      position:absolute;
      inset:0;
      background: radial-gradient(ellipse at center, rgba(0,0,0,.12), rgba(0,0,0,.55));
      pointer-events:none;
    }
    .hero-dots{
      position:absolute;
      left:0; right:0;
      bottom:14px;
      display:flex;
      justify-content:center;
      gap:8px;
      z-index:5;
    }
    .dot{
      width:8px; height:8px;
      border-radius:999px;
      background:rgba(255,255,255,.45);
      border:1px solid rgba(255,255,255,.25);
    }
    .dot.active{ background:#fff; }

    .grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap:22px;
    }
    @media (max-width: 860px){
      .topbar{ grid-template-columns: 140px 1fr 80px; }
      .brand-title{ font-size:16px; }
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      border:1px solid var(--line);
      border-radius: var(--radius);
      overflow:hidden;
      background:#fff;
      box-shadow: 0 1px 0 rgba(0,0,0,.03);
    }
    .poster{
      width:100%;
      aspect-ratio: 16 / 9;
      background:#f6f6f6;
      overflow:hidden;
      cursor:pointer;
    }
    .poster img{
      width:100%;
      height:100%;
      object-fit:cover;
      transform: scale(1.01);
      transition: transform .35s ease;
    }
    .poster:hover img{ transform: scale(1.06); }

    .meta{ padding:14px 14px 16px; }
    .show-title{
      font-weight:800;
      font-size:18px;
      letter-spacing:-.02em;
      margin:0 0 6px;
    }
    .show-date{
      font-weight:400;
      color:var(--gray-2);
      margin:0;
      line-height:1.5;
    }

    .social-row{
      margin-top:18px;
      display:flex;
      justify-content:center;
      gap:16px;
      flex-wrap:wrap;
    }
    .icon-btn{
      display:inline-flex;
      align-items:center;
      gap:10px;
      border:1px solid var(--line);
      background:#fff;
      padding:10px 14px;
      border-radius:999px;
      box-shadow: 0 6px 20px rgba(0,0,0,.06);
      font-weight:800;
    }
    .icon-btn img{ width:22px; height:22px; object-fit:contain; }

    .modal-backdrop{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      padding:16px;
      z-index:100;
    }
    .modal-backdrop.open{ display:flex; }
    .modal{
      width:min(980px, 100%);
      max-height: 92vh;
      overflow:auto;
      background:#fff;
      border-radius: 16px;
      box-shadow: var(--shadow);
      position:relative;
    }
    .modal-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      padding:14px 16px;
      border-bottom:1px solid var(--line);
      position:sticky;
      top:0;
      background:#fff;
      z-index:2;
    }
    .modal-header .mh-title{ font-weight:900; letter-spacing:-.02em; }
    .close{
      border:1px solid var(--line);
      background:#fff;
      border-radius:10px;
      padding:8px 10px;
      cursor:pointer;
      font-weight:800;
    }
    .modal-body{ padding:16px; }
    .detail-img{
      width:100%;
      height:auto;
      border-radius:12px;
      border:1px solid var(--line);
    }

    .tabs{
      display:flex;
      justify-content:center;
      gap:10px;
      flex-wrap:wrap;
      margin:10px 0 18px;
    }
    .tab{
      border:1px solid var(--line);
      background:#fff;
      border-radius:999px;
      padding:10px 14px;
      cursor:pointer;
      font-weight:800;
    }
    .tab.active{
      border-color:#000;
      outline:2px solid rgba(0,0,0,.12);
    }
    .about-panel{
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:18px;
      background:#fff;
    }
    .about-text{
      font-size:15px;
      line-height:1.8;
      color:#222;
      margin:0;
    }
    .about-images{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:14px;
      margin-top:14px;
    }
    @media (max-width: 860px){
      .about-images{ grid-template-columns: 1fr; }
    }
    .about-images img{
      width:100%;
      border-radius:12px;
      border:1px solid var(--line);
    }

    .cal-wrap{
      border:1px solid var(--line);
      border-radius: var(--radius);
      overflow:hidden;
      background:#fff;
    }
    .cal-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:12px 14px;
      border-bottom:1px solid var(--line);
    }
    .cal-head .month{ font-weight:900; letter-spacing:-.02em; }
    .cal-head button{
      border:1px solid var(--line);
      background:#fff;
      border-radius:10px;
      padding:8px 10px;
      cursor:pointer;
      font-weight:800;
    }
    .cal-grid{ display:grid; grid-template-columns: repeat(7, minmax(0,1fr)); }
    .dow{
      background:#fafafa;
      padding:10px 8px;
      font-weight:900;
      border-bottom:1px solid var(--line);
      border-right:1px solid var(--line);
      text-align:center;
      font-size:13px;
    }
    .dow:nth-child(7){ border-right:none; }
    .day{
      min-height:92px;
      padding:8px;
      border-bottom:1px solid var(--line);
      border-right:1px solid var(--line);
      position:relative;
    }
    .day:nth-child(7n){ border-right:none; }
    .day .n{
      position:absolute;
      top:8px; right:8px;
      font-size:12px;
      color:#444;
      font-weight:800;
    }
    .events{
      margin-top:22px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .ev{ display:flex; align-items:center; gap:6px; font-size:12px; line-height:1.25; }
    .badge{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      width:20px;
      height:18px;
      border-radius:5px;
      font-weight:900;
      color:#fff;
      flex:0 0 auto;
    }
    .b1{ background:var(--badge1); }
    .b2{ background:var(--badge2); }
    .ev .t{
      color:#111;
      font-weight:700;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }

    .admin-box{
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:18px;
      background:#fff;
    }
    .admin-login{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .admin-login input{
      border:1px solid var(--line);
      border-radius:10px;
      padding:10px 12px;
      min-width:240px;
    }
    .admin-login button{
      border:1px solid #000;
      background:#000;
      color:#fff;
      border-radius:10px;
      padding:10px 12px;
      cursor:pointer;
      font-weight:900;
    }
    .admin-tools{
      margin-top:10px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .admin-tools button{
      border:1px solid var(--line);
      background:#fff;
      border-radius:10px;
      padding:10px 12px;
      cursor:pointer;
      font-weight:900;
    }
    .admin-tools button.danger{
      border-color:#b00020;
      color:#b00020;
    }

    .admin-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
      margin-top:14px;
    }
    @media (max-width: 860px){
      .admin-grid{ grid-template-columns: 1fr; }
    }
    textarea{
      width:100%;
      min-height:320px;
      resize:vertical;
      border:1px solid var(--line);
      border-radius:12px;
      padding:12px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size:12px;
      line-height:1.5;
    }
    .savebar{
      display:flex;
      gap:10px;
      margin-top:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .savebar button{
      border:1px solid var(--line);
      background:#fff;
      border-radius:10px;
      padding:10px 12px;
      cursor:pointer;
      font-weight:900;
    }
    .savebar button.primary{
      border-color:#000;
      background:#000;
      color:#fff;
    }
    .hint{
      font-size:12px;
      color:#555;
      line-height:1.6;
      margin:8px 0 0;
    }

    footer{
      margin-top:46px;
      background: var(--footer-bg);
      border-top:1px solid rgba(0,0,0,.08);
      padding:22px 0;
    }
    .footer-lines{
      text-align:center;
      display:flex;
      flex-direction:column;
      gap:10px;
      font-size:14px;
      line-height:1.6;
      color:#000;
    }
    .b{ font-weight:900; }
    .r{ font-weight:400; }
    .footer-lines a{ text-decoration: underline; text-underline-offset: 3px; }

    .anchor { scroll-margin-top: 120px; }
  </style>
</head>

<body>

<header>
  <div class="wrap">
    <div class="topbar">
      <div class="brand-left">
        <img src="images/logo/문화락로고cmyk.png" alt="문화락 로고" />
      </div>
      <div class="brand-title">인증사회적기업(주)문화락</div>
      <div class="brand-right"></div>
    </div>

    <nav>
      <div class="menu" id="menu">
        <a href="#current" data-link="current">현재공연</a>
        <a href="#past" data-link="past">이전공연</a>
        <a href="#about" data-link="about">공연단체소개</a>
        <a href="#rental" data-link="rental">공연대관일정</a>
        <a href="#admin" data-link="admin">관리자</a>
      </div>
    </nav>
  </div>
</header>

<section class="hero" aria-label="메인 슬라이드">
  <div class="hero-track" id="heroTrack"></div>
  <div class="hero-overlay"></div>
  <div class="hero-dots" id="heroDots"></div>
</section>

<main>
  <section class="section anchor" id="current">
    <div class="wrap">
      <h2 class="section-title">현재공연</h2>
      <div class="grid" id="currentGrid"></div>
    </div>
  </section>

  <section class="section anchor" id="past">
    <div class="wrap">
      <h2 class="section-title">이전공연</h2>
      <div class="grid" id="pastGrid"></div>

      <div class="social-row" aria-label="SNS 링크">
        <a class="icon-btn" href="https://www.instagram.com/gaonarthall" target="_blank" rel="noreferrer">
          <img src="images/icons/Instagram로고.png" alt="Instagram" />
          <span>Instagram</span>
        </a>
        <a class="icon-btn" href="https://blog.naver.com/gaonarthall12" target="_blank" rel="noreferrer">
          <img src="images/icons/블로그로고.png" alt="Blog" />
          <span>Blog</span>
        </a>
      </div>
    </div>
  </section>

  <section class="section anchor" id="about">
    <div class="wrap">
      <h2 class="section-title">공연단체소개</h2>

      <div class="tabs" role="tablist" aria-label="공연단체소개 탭">
        <button class="tab active" data-tab="intro" type="button">1) (주)문화락 소개</button>
        <button class="tab" data-tab="history" type="button">2) 실적</button>
        <button class="tab" data-tab="works" type="button">3) 문화락 제작 공연</button>
      </div>

      <div class="about-panel" id="aboutPanel"></div>
    </div>
  </section>

  <section class="section anchor" id="rental">
    <div class="wrap">
      <h2 class="section-title">공연대관일정</h2>
      <p class="muted" style="margin-top:-6px;">
        달력 날짜 칸에 <b>①(1관)</b> / <b>②(2관)</b> 표시됩니다. (관리자에서 수정 가능)
      </p>

      <div class="cal-wrap">
        <div class="cal-head">
          <button id="prevMonth" type="button">◀</button>
          <div class="month" id="monthLabel"></div>
          <button id="nextMonth" type="button">▶</button>
        </div>
        <div class="cal-grid" id="calDows"></div>
        <div class="cal-grid" id="calDays"></div>
      </div>
    </div>
  </section>

  <section class="section anchor" id="admin">
    <div class="wrap">
      <h2 class="section-title">관리자</h2>

      <div class="admin-box" id="adminBox">
        <div class="admin-login" id="adminLogin">
          <input id="adminPass" type="password" placeholder="관리자 비밀번호 입력" />
          <button id="adminEnter" type="button">로그인</button>
          <p class="hint">※ 이 페이지는 브라우저(localStorage) 저장 방식입니다.</p>
        </div>

        <div class="admin-tools" id="adminTools" style="display:none;">
          <input id="newPass" type="password" placeholder="새 비밀번호" />
          <input id="newPass2" type="password" placeholder="새 비밀번호 확인" />
          <button id="changePass" type="button">비밀번호 변경</button>
          <button class="danger" id="resetPass" type="button">비밀번호 초기화</button>
        </div>

        <div id="adminPanel" style="display:none;">
          <div class="admin-grid">
            <div>
              <h3 style="margin:0 0 10px; font-weight:900;">현재공연 데이터(JSON)</h3>
              <textarea id="adminCurrent"></textarea>
            </div>
            <div>
              <h3 style="margin:0 0 10px; font-weight:900;">이전공연 데이터(JSON)</h3>
              <textarea id="adminPast"></textarea>
            </div>
          </div>

          <div style="margin-top:14px;">
            <h3 style="margin:0 0 10px; font-weight:900;">공연대관일정 데이터(JSON)</h3>
            <textarea id="adminRental"></textarea>
          </div>

          <div class="savebar">
            <button class="primary" id="saveAll" type="button">저장하기</button>
            <button id="resetAll" type="button">기본값으로 되돌리기</button>
            <button id="logout" type="button">로그아웃</button>
          </div>

          <p class="hint">
            ✅ JSON 예시(공연): {"title":"공연명","dateText":"2026.1.24~4.26","poster":"images/posters/current/current_01.jpg","detail":"images/details/리온마술-상세.jpg"}<br/>
            ✅ JSON 예시(대관): {"date":"2026-01-03","hall":1,"title":"리온의 신비한 과자상점"}
          </p>
        </div>
      </div>
    </div>
  </section>
</main>

<footer>
  <div class="wrap">
    <div class="footer-lines">
      <div>
        <span class="b">상호명</span> <span class="r">(주)문화락</span>
        &nbsp;&nbsp;|&nbsp;&nbsp;
        <span class="b">사업장 주소</span> <span class="r">부산광역시 동구 자성로133번길 지하1층</span>
        &nbsp;&nbsp;|&nbsp;&nbsp;
        <span class="b">대표전화</span> <span class="r">1600-1602</span>
      </div>
      <div>
        <span class="b">이메일</span> <span class="r">16001602@hanmail.net</span>
        &nbsp;&nbsp;|&nbsp;&nbsp;
        <span class="b">사업자 등록번호</span> <span class="r">605-86-13527</span>
      </div>
      <div>
        <span class="b">홈페이지</span> <span class="r"><a href="https://culturelock.co.kr" target="_blank" rel="noreferrer">https://culturelock.co.kr</a></span>
        &nbsp;&nbsp;|&nbsp;&nbsp;
        <span class="b">인스타</span> <span class="r"><a href="https://www.instagram.com/gaonarthall" target="_blank" rel="noreferrer">https://www.instagram.com/gaonarthall</a></span>
        &nbsp;&nbsp;|&nbsp;&nbsp;
        <span class="b">블로그</span> <span class="r"><a href="https://blog.naver.com/gaonarthall12" target="_blank" rel="noreferrer">https://blog.naver.com/gaonarthall12</a></span>
      </div>
    </div>
  </div>
</footer>

<div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-label="공연 상세">
  <div class="modal">
    <div class="modal-header">
      <div class="mh-title" id="modalTitle">상세보기</div>
      <button class="close" id="modalClose" type="button">닫기 ✕</button>
    </div>
    <div class="modal-body">
      <img class="detail-img" id="modalImg" alt="공연 상세 이미지" />
    </div>
  </div>
</div>

<script>
  /********************
   * 기본 데이터(초기값)
   ********************/
  const DEFAULT = {
    hero: [
      "images/slides/slide1.jpg",
      "images/slides/slide2.jpg",
      "images/slides/slide3.jpg",
    ],
    currentShows: [
      {"title":"연극 황소와 도깨비","dateText":"2025.12.21 ~ 2026.01.31","poster":"images/posters/current/current_01.jpg","detail":"images/details/황소와도깨비-상세.jpg"},
      {"title":"공연·마술 리온의 신비한 과자상점","dateText":"2026.01.24 ~ 2026.04.26","poster":"images/posters/current/current_02.jpg","detail":"images/details/리온마술-상세.jpg"}
    ],
    pastShows: [
      {"title":"연극 죽여주는 이야기","dateText":"2025.11.27 ~ 2025.12.28","poster":"images/posters/past/past_01.jpg","detail":"images/details/죽여주는이야기-상세.jpg"},
      {"title":"조항조 콘서트","dateText":"2025.05.17","poster":"images/posters/past/past_02.jpg","detail":"images/details/조항조부산-상세페이지2탄.jpg"},
      {"title":"2025 Jazz Christmas","dateText":"2025.12.05","poster":"images/posters/past/past_03.jpg","detail":"images/details/25년상세최종.jpg"}
    ],
    rental: [
      {"date":"2026-01-03","hall":1,"title":"리온의 신비한 과자상점"},
      {"date":"2026-01-03","hall":2,"title":"안형순"},
      {"date":"2026-01-10","hall":1,"title":"리온의 신비한 과자상점"},
      {"date":"2026-01-10","hall":2,"title":"안형순"}
    ],
    about: {
      introText:
`(주)문화락은 공연 컨텐츠를 개발, 제작, 육성하여 보급하며 학교 단체공연 및 각종 기업, 지역 축제 등 행사에 적합한 공연 컨텐츠를 추천 및 기획과 연출을 전문으로 하는 공연기획사입니다.
가온아트홀 1관은 170석 규모를 갖추고 있으며 연극, 뮤지컬 등 다양한 장르의 공연을 수용할 수 있는 다목적 공연장에 음향, 조명설비를 완비하여 각종 공연과 행사를 진행 할 수 있는 공연장입니다.
가온아트홀 2관은 100석 규모의 공간으로 연극, 뮤지컬 등 각종발표회 강연회, 교육등을 할 수 있도록 꾸며진 공연장입니다.`,
      introImages: ["images/about/문화락소개2.jpg","images/about/문화락소개3.jpg"],
      historyImages: ["images/about/문화락소개19.jpg"],
      worksImages: ["images/about/문화락소개9.jpg"]
    }
  };

  /********************
   * 저장/로드
   ********************/
  const LS_KEY = "culturelock_site_v1";
  const LS_ADMIN_PASS = "culturelock_admin_pass_v1";
  const ADMIN_DEFAULT_PASS = "1600-1602";

  function loadData(){
    try{
      const raw = localStorage.getItem(LS_KEY);
      if(!raw) return structuredClone(DEFAULT);
      const parsed = JSON.parse(raw);
      return { ...structuredClone(DEFAULT), ...parsed };
    }catch(e){
      return structuredClone(DEFAULT);
    }
  }
  function saveData(data){ localStorage.setItem(LS_KEY, JSON.stringify(data)); }
  function resetData(){
    localStorage.removeItem(LS_KEY);
    DATA = loadData();
    renderAll();
  }

  function getAdminPass(){
    return localStorage.getItem(LS_ADMIN_PASS) || ADMIN_DEFAULT_PASS;
  }
  function setAdminPass(pw){
    localStorage.setItem(LS_ADMIN_PASS, pw);
  }
  function resetAdminPass(){
    localStorage.removeItem(LS_ADMIN_PASS);
  }

  let DATA = loadData();

  /********************
   * 메뉴 active
   ********************/
  const menu = document.getElementById("menu");
  function setActiveMenu(){
    const hash = (location.hash || "#current").replace("#","");
    [...menu.querySelectorAll("a")].forEach(a=>{
      a.classList.toggle("active", a.dataset.link === hash);
    });
  }
  window.addEventListener("hashchange", setActiveMenu);
  setActiveMenu();

  /********************
   * Hero Slider
   ********************/
  const heroTrack = document.getElementById("heroTrack");
  const heroDots  = document.getElementById("heroDots");
  let heroIndex = 0;
  let heroTimer = null;

  function renderHero(){
    const slides = (DATA.hero || []).filter(Boolean);
    const safeSlides = slides.length ? slides : ["images/slides/slide1.jpg"];

    heroTrack.innerHTML = safeSlides.map(src => `
      <div class="hero-slide"><img src="${src}" alt="메인 슬라이드"></div>
    `).join("");

    heroDots.innerHTML = safeSlides.map((_, i)=>`
      <span class="dot ${i===0?"active":""}"></span>
    `).join("");

    heroIndex = 0;
    moveHero(0);

    if(heroTimer) clearInterval(heroTimer);
    heroTimer = setInterval(()=>{
      heroIndex = (heroIndex + 1) % safeSlides.length;
      moveHero(heroIndex);
    }, 6500);
  }

  function moveHero(idx){
    heroTrack.style.transform = `translateX(-${idx*100}%)`;
    [...heroDots.querySelectorAll(".dot")].forEach((d,i)=>{
      d.classList.toggle("active", i===idx);
    });
  }

  /********************
   * 공연 카드
   ********************/
  const currentGrid = document.getElementById("currentGrid");
  const pastGrid = document.getElementById("pastGrid");

  function showCardHTML(item){
    return `
      <div class="card">
        <div class="poster" data-detail="${item.detail || ""}" data-title="${escapeHtml(item.title || "")}">
          <img src="${item.poster || ""}" alt="${escapeHtml(item.title || "공연 포스터")}">
        </div>
        <div class="meta">
          <p class="show-title">${escapeHtml(item.title || "")}</p>
          <p class="show-date">${escapeHtml(item.dateText || "")}</p>
        </div>
      </div>
    `;
  }

  function renderShows(){
    currentGrid.innerHTML = (DATA.currentShows || []).map(showCardHTML).join("");
    pastGrid.innerHTML    = (DATA.pastShows || []).map(showCardHTML).join("");

    document.querySelectorAll(".poster").forEach(el=>{
      el.addEventListener("click", ()=>{
        const detail = el.dataset.detail;
        const title  = el.dataset.title || "상세보기";
        if(!detail){
          alert("상세 이미지(detail)가 아직 없습니다. 관리자에서 detail 파일명을 넣어주세요.");
          return;
        }
        openModal(title, detail);
      });
    });
  }

  /********************
   * 모달
   ********************/
  const modalBackdrop = document.getElementById("modalBackdrop");
  const modalClose = document.getElementById("modalClose");
  const modalTitle = document.getElementById("modalTitle");
  const modalImg   = document.getElementById("modalImg");

  function openModal(title, imgSrc){
    modalTitle.textContent = title;
    modalImg.src = imgSrc;
    modalBackdrop.classList.add("open");
  }
  function closeModal(){
    modalBackdrop.classList.remove("open");
    modalImg.src = "";
  }
  modalClose.addEventListener("click", closeModal);
  modalBackdrop.addEventListener("click", (e)=>{ if(e.target === modalBackdrop) closeModal(); });
  window.addEventListener("keydown", (e)=>{ if(e.key === "Escape") closeModal(); });

  /********************
   * 공연단체소개 탭
   ********************/
  const aboutPanel = document.getElementById("aboutPanel");
  const tabs = [...document.querySelectorAll(".tab")];

  function renderAbout(tabKey){
    const A = DATA.about || DEFAULT.about;

    if(tabKey === "intro"){
      aboutPanel.innerHTML = `
        <p class="about-text">${escapeHtml(A.introText).replaceAll("\n","<br>")}</p>
        <div class="about-images">
          ${(A.introImages||[]).map(src=>`<img src="${src}" alt="문화락 소개 이미지">`).join("")}
        </div>
      `;
      return;
    }

    if(tabKey === "history"){
      aboutPanel.innerHTML = `
        <p class="about-text"><b>문화락 연혁/실적</b> (이미지로 표시)</p>
        <div class="about-images">
          ${(A.historyImages||[]).map(src=>`<img src="${src}" alt="문화락 실적 이미지">`).join("")}
        </div>
      `;
      return;
    }

    aboutPanel.innerHTML = `
      <p class="about-text"><b>문화락 제작 공연</b> (이미지로 표시)</p>
      <div class="about-images">
        ${(A.worksImages||[]).map(src=>`<img src="${src}" alt="문화락 제작공연 이미지">`).join("")}
      </div>
    `;
  }

  tabs.forEach(btn=>{
    btn.addEventListener("click", ()=>{
      tabs.forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      renderAbout(btn.dataset.tab);
    });
  });

  /********************
   * 대관 달력
   ********************/
  const calDows = document.getElementById("calDows");
  const calDays = document.getElementById("calDays");
  const monthLabel = document.getElementById("monthLabel");
  const prevMonth = document.getElementById("prevMonth");
  const nextMonth = document.getElementById("nextMonth");

  const DOWS = ["일","월","화","수","목","금","토"];
  calDows.innerHTML = DOWS.map(d=>`<div class="dow">${d}</div>`).join("");

  let viewDate = new Date();
  viewDate.setDate(1);

  function ymd(d){
    const y = d.getFullYear();
    const m = String(d.getMonth()+1).padStart(2,"0");
    const day = String(d.getDate()).padStart(2,"0");
    return `${y}-${m}-${day}`;
  }

  function renderCalendar(){
    const y = viewDate.getFullYear();
    const m = viewDate.getMonth();
    monthLabel.textContent = `${y}.${String(m+1).padStart(2,"0")}`;

    const first = new Date(y,m,1);
    const last  = new Date(y,m+1,0);
    const startDow = first.getDay();
    const totalDays = last.getDate();

    const rentalList = DATA.rental || [];
    const map = new Map();
    rentalList.forEach(r=>{
      if(!r?.date) return;
      const arr = map.get(r.date) || [];
      arr.push(r);
      map.set(r.date, arr);
    });

    const cells = [];
    for(let i=0;i<startDow;i++){
      cells.push(`<div class="day" style="background:#fcfcfc;"></div>`);
    }

    for(let d=1; d<=totalDays; d++){
      const dt = new Date(y,m,d);
      const key = ymd(dt);
      const evs = map.get(key) || [];
      const evHtml = evs.slice(0,4).map(ev=>{
        const is1 = Number(ev.hall) === 1;
        const badge = is1 ? "①" : "②";
        const cls = is1 ? "b1" : "b2";
        return `
          <div class="ev" title="${escapeHtml(ev.title||"")}">
            <span class="badge ${cls}">${badge}</span>
            <span class="t">${escapeHtml(ev.title||"")}</span>
          </div>
        `;
      }).join("");

      cells.push(`
        <div class="day">
          <span class="n">${d}</span>
          <div class="events">${evHtml}</div>
        </div>
      `);
    }

    const totalCells = startDow + totalDays;
    const extra = (7 - (totalCells % 7)) % 7;
    for(let i=0;i<extra;i++){
      cells.push(`<div class="day" style="background:#fcfcfc;"></div>`);
    }

    calDays.innerHTML = cells.join("");
  }

  prevMonth.addEventListener("click", ()=>{
    viewDate = new Date(viewDate.getFullYear(), viewDate.getMonth()-1, 1);
    renderCalendar();
  });
  nextMonth.addEventListener("click", ()=>{
    viewDate = new Date(viewDate.getFullYear(), viewDate.getMonth()+1, 1);
    renderCalendar();
  });

  /********************
   * 관리자 (비번 변경/초기화 + 데이터 저장)
   ********************/
  const adminEnter = document.getElementById("adminEnter");
  const adminPass  = document.getElementById("adminPass");
  const adminLogin = document.getElementById("adminLogin");
  const adminPanel = document.getElementById("adminPanel");

  const adminTools = document.getElementById("adminTools");
  const newPass = document.getElementById("newPass");
  const newPass2 = document.getElementById("newPass2");
  const changePassBtn = document.getElementById("changePass");
  const resetPassBtn = document.getElementById("resetPass");

  const adminCurrent = document.getElementById("adminCurrent");
  const adminPast    = document.getElementById("adminPast");
  const adminRental  = document.getElementById("adminRental");

  const saveAll = document.getElementById("saveAll");
  const resetAllBtn = document.getElementById("resetAll");
  const logoutBtn = document.getElementById("logout");

  function openAdmin(){
    adminLogin.style.display = "none";
    adminTools.style.display = "flex";
    adminPanel.style.display = "block";

    adminCurrent.value = JSON.stringify(DATA.currentShows || [], null, 2);
    adminPast.value    = JSON.stringify(DATA.pastShows || [], null, 2);
    adminRental.value  = JSON.stringify(DATA.rental || [], null, 2);
  }

  adminEnter.addEventListener("click", ()=>{
    const input = (adminPass.value || "").trim();
    if(input === getAdminPass()){
      openAdmin();
    }else{
      alert("비밀번호가 틀렸습니다.\n(기본값: 1600-1602 / 또는 본인이 변경한 비번)");
    }
  });

  changePassBtn.addEventListener("click", ()=>{
    const p1 = (newPass.value||"").trim();
    const p2 = (newPass2.value||"").trim();
    if(!p1 || p1.length < 4){
      alert("새 비밀번호를 4자 이상으로 입력하세요.");
      return;
    }
    if(p1 !== p2){
      alert("새 비밀번호 확인이 일치하지 않습니다.");
      return;
    }
    setAdminPass(p1);
    newPass.value = "";
    newPass2.value = "";
    alert("비밀번호가 변경되었습니다. (이 브라우저에 저장됨)");
  });

  resetPassBtn.addEventListener("click", ()=>{
    if(confirm("비밀번호를 기본값(1600-1602)으로 초기화할까요?")){
      resetAdminPass();
      newPass.value = "";
      newPass2.value = "";
      alert("초기화 완료! 기본 비번은 1600-1602 입니다.");
    }
  });

  saveAll.addEventListener("click", ()=>{
    try{
      const next = structuredClone(DATA);
      next.currentShows = JSON.parse(adminCurrent.value || "[]");
      next.pastShows    = JSON.parse(adminPast.value || "[]");
      next.rental       = JSON.parse(adminRental.value || "[]");
      DATA = next;
      saveData(DATA);
      renderAll();
      alert("저장되었습니다. (이 브라우저에 저장됨)");
    }catch(e){
      alert("JSON 형식이 잘못되었습니다. 쉼표/괄호를 확인해주세요.");
    }
  });

  resetAllBtn.addEventListener("click", ()=>{
    if(confirm("사이트 데이터(공연/대관)를 기본값으로 되돌릴까요?")){
      resetData();
      alert("기본값으로 되돌렸습니다.");
      adminPanel.style.display = "none";
      adminTools.style.display = "none";
      adminLogin.style.display = "flex";
      adminPass.value = "";
    }
  });

  logoutBtn.addEventListener("click", ()=>{
    adminPanel.style.display = "none";
    adminTools.style.display = "none";
    adminLogin.style.display = "flex";
    adminPass.value = "";
  });

  /********************
   * 전체 렌더
   ********************/
  function renderAll(){
    setActiveMenu();
    renderHero();
    renderShows();
    renderAbout("intro");
    renderCalendar();
  }

  function escapeHtml(str){
    return String(str ?? "")
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  renderAll();
</script>

</body>
</html>
